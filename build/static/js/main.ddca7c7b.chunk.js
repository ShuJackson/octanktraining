(this.webpackJsonpVodAws=this.webpackJsonpVodAws||[]).push([[0],{152:function(e,t,n){e.exports=n.p+"static/media/logo.25bf045c.svg"},168:function(e,t,n){e.exports=n(606)},173:function(e,t,n){},175:function(e,t,n){},180:function(e,t,n){},181:function(e,t){},193:function(e,t,n){},194:function(e,t,n){},603:function(e,t,n){},604:function(e,t,n){},606:function(e,t,n){"use strict";n.r(t);var a=n(51),o=n.n(a);n(173),n(174),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(0),s=n.n(i),r=n(160),c=n(46),l=(n(175),n(56)),u=n.n(l),d=n(37),p=n(38),m=n(40),h=n(39),v=n(45),f=n(41),g=n(65),b=n(610),y=n(608),k=n(609),E=n(148),O=(n(180),n(68)),A=(n(193),function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){O.a.Hls.xhr.beforeRequest=function(e){return e.uri="".concat(e.uri).concat(O.a.getAllPlayers()[0].options().token),e},this.player=Object(O.a)(this.videoNode,this.props)}},{key:"componentWillUnmount",value:function(){this.player&&this.player.dispose()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{"data-vjs-player":!0},s.a.createElement("video",{ref:function(t){e.videoNode=t},className:"video-js"})))}}]),t}(s.a.Component)),j=(n(194),n(152)),w=n.n(j),_=function(e){var t=e.item,n=t.title,a=t.details;return s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"container"},s.a.createElement("img",{src:w.a,alt:"Movie"}),n,s.a.createElement("p",null,a)))};_.defaultProps={item:{title:"Default Title",details:"Default Details"}};var C=_,V=(n(195),n(16)),x="\n  query ListVodAssets(\n    $filter: ModelvodAssetFilterInput\n    $limit: Int\n    $nextToken: String\n  ) {\n    listVodAssets(filter: $filter, limit: $limit, nextToken: $nextToken) {\n      items {\n        id\n        title\n        description\n        video {\n          id\n          token\n          createdAt\n          updatedAt\n        }\n        createdAt\n        updatedAt\n      }\n      nextToken\n    }\n  }\n",P={awsInputVideo:"vodawsstack-rs3inputbucket-14923nd7x1-inputbucket-1ojawrokd5za0",awsOutputVideo:"d2mz09g152qu4f.cloudfront.net"},N=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).hideMovie=function(){n.setState({displayingMovie:!1})},n.displayMovie=function(e){V.d._config.aws_project_region;n.setState({sources:[{src:"https://".concat(P.awsOutputVideo,"/").concat(e.video.id,".m3u8"),type:"application/x-mpegURL"}],displayingMovie:!0,choosenItem:e,token:e.video.token})},n.overlayMovie=function(){var e=n.state,t=e.displayingMovie,a=e.sources,o=e.choosenItem,i=o.title,r=o.description,c=e.token;return s.a.createElement(b.a,{id:"popup",style:{maxWidth:755},isOpen:t,toggle:n.hideMovie},s.a.createElement(y.a,{toggle:n.hideMovie},i),s.a.createElement(k.a,null,r,s.a.createElement(A,{controls:!0,sources:a,width:720,height:420,bigPlayButton:!1,autoplay:!0,token:c})))},n.listenForNewAssets=function(){V.a.graphql(Object(V.e)("\n  subscription OnCreateVodAsset {\n    onCreateVodAsset {\n      id\n      title\n      description\n      video {\n        id\n        token\n        createdAt\n        updatedAt\n      }\n      createdAt\n      updatedAt\n    }\n  }\n")).subscribe({next:function(e){var t=n.state.items;t.push(e.value.data.onCreateVodAsset),n.setState({items:t})}})},n.state={displayingMovie:!1,choosenItem:{},nextToken:"",sources:[],items:[]},n.handleOnDocumentBottom=n.handleOnDocumentBottom.bind(Object(v.a)(n)),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e,t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.a.awrap(V.a.graphql(Object(V.e)(x)));case 2:e=n.sent,void 0===(t=e.data.listVodAssets.nextToken)&&(t=""),this.setState({items:e.data.listVodAssets.items,nextToken:t}),this.listenForNewAssets();case 7:case"end":return n.stop()}}),null,this)}},{key:"handleOnDocumentBottom",value:function(){var e,t,n,a,o,i;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e=this.state,t=e.nextToken,n=e.items,""===t||null===t||void 0===t){s.next=10;break}return console.log(t),s.next=5,u.a.awrap(V.a.graphql(Object(V.e)(x,{nextToken:t})));case 5:a=s.sent,o=n.concat(a.data.listVodAssets.items),void 0===(i=a.data.listVodAssets.nextToken)&&(i=""),this.setState({items:o,nextToken:i});case 10:case"end":return s.stop()}}),null,this)}},{key:"render",value:function(){var e=this,t=this.state.items.map((function(t){return s.a.createElement(g.a,{xs:6,sm:4,lg:3.5,style:{paddingTop:15,paddingBottom:15},key:t.id},s.a.createElement("button",{type:"button",onClick:function(n){return e.displayMovie(t,n)},"aria-label":t.title},s.a.createElement(C,{item:t})))}));return s.a.createElement("div",{style:{paddingTop:85}},this.overlayMovie(),s.a.createElement(E.a,{onBottom:this.handleOnDocumentBottom}),s.a.createElement(g.b,{fluid:!0},s.a.createElement(g.c,null,t)))}}]),t}(i.Component),M=n(64);var S=Object(M.a)((function(){return s.a.createElement("div",{className:"App"},s.a.createElement("header",{className:"App-header"},s.a.createElement(N,null)))}),!0),T=n(158),I=(n(603),n(79)),$=n.n(I),D=(n(604),function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).state={filePicked:""},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"onChange",value:function(e){var t=e.target.files[0],n=this.props.callbackFromParent;this.setState({filePicked:t.name}),n(t),e.preventDefault()}},{key:"render",value:function(){var e=this,t="Choose a file...";return""!==this.state.filePicked&&(t="Movie file selected"),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"FilePicker",className:"fileInput"},t,s.a.createElement("input",{type:"file",name:"file",id:"FilePicker",className:"inputfile",accept:"video/*",onChange:function(t){return e.onChange(t)}})))}}]),t}(i.Component)),F=n(163),B=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).hideProgress=function(){n.setState({showing:!1})},n.progressInfo=function(){var e=n.props.progress,t=s.a.createElement("div",null,"Error!");return e>=100||e<=0?t=s.a.createElement("div",null,"Upload Complete!"):e>0&&(t=s.a.createElement(F.a,{now:e})),t},n.overlayProgress=function(){var e=n.state.showing;return s.a.createElement(b.a,{id:"popup",style:{maxWidth:755},isOpen:e,toggle:n.hideProgress},s.a.createElement(y.a,{toggle:n.hideProgress},"Upload Progress"),s.a.createElement(k.a,null,n.progressInfo()))},n.state={showing:!1},n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,this.overlayProgress())}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.progress,a=t;return n>0&&n<100&&(a.showing=!0),a}}]),t}(i.Component),q=function(e){function t(e){var n;return Object(d.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).myCallback=function(e){n.setState({file:e,fileName:e.name})},n.state={titleVal:"",descVal:"",groups:[],progress:0},n.submitFormHandler=n.submitFormHandler.bind(Object(v.a)(n)),n.handleChange=n.handleChange.bind(Object(v.a)(n)),n.createAdminPanel=n.createAdminPanel.bind(Object(v.a)(n)),n}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=V.d._config.aws_project_region;V.b.currentSession().then((function(t){t.idToken.payload["cognito:groups"]&&e.setState({groups:t.idToken.payload["cognito:groups"]})})),V.c.configure({AWSS3:{bucket:P.awsInputVideo,region:t}})}},{key:"handleChange",value:function(e){var t=e.target.value,n=e.target.name;this.setState(Object(T.a)({},n,t))}},{key:"handledescChange",value:function(e){this.setState({descVal:e.target.value})}},{key:"submitFormHandler",value:function(e){var t=this;e.preventDefault();var n=$()(),a=this,o={input:{id:n}};V.a.graphql(Object(V.e)("\n  mutation CreateVideoObject(\n    $input: CreateVideoObjectInput!\n    $condition: ModelvideoObjectConditionInput\n  ) {\n    createVideoObject(input: $input, condition: $condition) {\n      id\n      token\n      createdAt\n      updatedAt\n    }\n  }\n",o)).then((function(e,o){if(void 0===o){var i=t.state,s=i.titleVal,r=i.descVal,c=i.file,l=i.fileName.toLowerCase().split("."),u={input:{title:s,description:r,vodAssetVideoId:n}};V.a.graphql(Object(V.e)("\n  mutation CreateVodAsset(\n    $input: CreateVodAssetInput!\n    $condition: ModelvodAssetConditionInput\n  ) {\n    createVodAsset(input: $input, condition: $condition) {\n      id\n      title\n      description\n      video {\n        id\n        token\n        createdAt\n        updatedAt\n      }\n      createdAt\n      updatedAt\n    }\n  }\n",u)),V.c.put("".concat(n,".").concat(l[l.length-1]),c,{progressCallback:function(e){var t=e.loaded,n=e.total;console.log("Uploaded: ".concat(e.loaded,"/").concat(e.total)),a.setState({progress:t/n*100})},contentType:"video/*"}).then((function(){return console.log("Successfully Uploaded: ".concat(n))})).catch((function(e){return console.log("Error: ".concat(e))}))}}))}},{key:"createAdminPanel",value:function(){var e=this.state,t=e.groups,n=e.titleVal,a=e.descVal,o=e.progress;return t.includes("Admin")?s.a.createElement("div",null,s.a.createElement("header",null,s.a.createElement("h1",{className:"pageName"},"Admin Panel"),s.a.createElement("form",{onSubmit:this.submitFormHandler},s.a.createElement("div",null,s.a.createElement("input",{type:"text",value:n,name:"titleVal",placeholder:"Title",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement("textarea",{className:"desTextA",rows:"4",cols:"50",value:a,name:"descVal",placeholder:"Description",onChange:this.handleChange}),s.a.createElement("br",null),s.a.createElement(D,{callbackFromParent:this.myCallback}),s.a.createElement("label",{htmlFor:"submitButton",className:"submitLabel"},"Create Asset",s.a.createElement("input",{type:"submit",className:"submitButton",id:"submitButton",value:"Create Asset"})),s.a.createElement(B,{progress:o}))))):s.a.createElement("div",null,"Not Authenticated")}},{key:"render",value:function(){return s.a.createElement("div",{className:"adminHeader"},this.createAdminPanel())}}]),t}(s.a.Component),U=Object(M.a)(q,!0),H=s.a.createElement(r.a,null,s.a.createElement("div",null,s.a.createElement(c.a,{exact:!0,path:"/",component:S}),s.a.createElement(c.a,{path:"/Admin",component:U}),s.a.createElement(c.a,{path:"/App",component:S}))),W={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:1d13d1b7-68e2-4257-9a73-1a105b459dad",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_bsaQMv0aV",aws_user_pools_web_client_id:"1ru7n1v286rugmsv0flm5gg4ji",oauth:{},aws_appsync_graphqlEndpoint:"https://bmrbml3bzvdm7i2lgava3mpsgu.appsync-api.us-east-1.amazonaws.com/graphql",aws_appsync_region:"us-east-1",aws_appsync_authenticationType:"AMAZON_COGNITO_USER_POOLS",aws_content_delivery_bucket:"odws-20201010191626-hostingbucket-prod",aws_content_delivery_bucket_region:"us-east-1",aws_content_delivery_url:"https://dbavvzs66ssnu.cloudfront.net"};V.d.configure(W),o.a.render(H,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},75:function(e,t){}},[[168,1,2]]]);
//# sourceMappingURL=main.ddca7c7b.chunk.js.map